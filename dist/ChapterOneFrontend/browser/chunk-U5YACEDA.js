import{b as L}from"./chunk-7LAB7N4Z.js";import{i as P,k as $,l as z}from"./chunk-Q3W3MUE3.js";import{Ac as j,Bc as F,Ca as r,Hb as f,Ib as a,Jb as l,Kb as b,Lb as O,Mb as I,Qb as M,Ra as y,S as g,Vb as x,Wb as u,Xb as D,Z as v,_,bb as k,cb as d,db as m,gb as h,hb as C,ib as E,jb as t,kb as i,lb as c,wb as p,yc as T,za as S,zc as B}from"./chunk-6EE3YYJG.js";var G=(n,o)=>o.label;function U(n,o){n&1&&(t(0,"div",4),c(1,"div",6)(2,"div",7)(3,"div",8),i())}function V(n,o){if(n&1&&(t(0,"div",5),v(),t(1,"svg",9),c(2,"path",10),i(),_(),t(3,"h6",11),a(4,"Order not found"),i(),t(5,"p",12),a(6),i(),t(7,"a",13),a(8,"Back to Orders"),i()()),n&2){let e=p();r(6),l(e.error)}}function q(n,o){n&1&&(v(),t(0,"svg",42),c(1,"path",44),i())}function R(n,o){if(n&1&&(t(0,"span",43),a(1),i()),n&2){let e=p().$index;r(),l(e+1)}}function H(n,o){if(n&1&&(t(0,"div",19)(1,"div",41),a(2,"> "),d(3,q,2,0,":svg:svg",42)(4,R,2,1,"span",43),i(),t(5,"small"),a(6),i()()),n&2){let e=o.$implicit;r(),f(e.done?e.active?"bg-blue-600 text-white":"bg-accent text-white":"bg-bg-soft text-text-muted border border-border-light"),r(2),m(e.done&&!e.active?3:4),r(2),f(e.done?"font-semibold text-sm text-text-main":"text-sm text-text-muted"),r(),l(e.label)}}function N(n,o){n&1&&(t(0,"div",25),a(1,"No items"),i())}function Q(n,o){if(n&1&&c(0,"img",45),n&2){let e=p().$implicit;E("src",e.book==null?null:e.book.coverUrl,S)("alt",e.book==null?null:e.book.name)}}function J(n,o){n&1&&(t(0,"div",46),v(),t(1,"svg",50),c(2,"path",51),i()())}function K(n,o){if(n&1&&(t(0,"small",12),a(1),i()),n&2){let e=p(2).$implicit;r(),b("by ",e.book.author.name)}}function W(n,o){if(n&1&&(t(0,"h6",52),a(1),i(),d(2,K,2,1,"small",12)),n&2){let e=p().$implicit;r(),l(e.book.name),r(),m(e.book.author.name?2:-1)}}function X(n,o){n&1&&(t(0,"h6",48),a(1,"Book unavailable"),i())}function Y(n,o){if(n&1&&(t(0,"div",26),d(1,Q,1,2,"img",45)(2,J,3,0,"div",46),t(3,"div",47),d(4,W,3,2)(5,X,2,0,"h6",48),t(6,"small",49),a(7),x(8,"currency"),i()(),t(9,"div",11),a(10),x(11,"currency"),i()()),n&2){let e=o.$implicit;r(),m(e.book!=null&&e.book.coverUrl?1:2),r(3),m(e.book?4:5),r(3),O("Qty: ",e.quantity," \xB7 ",u(8,5,e.unitPrice)),r(3),l(u(11,7,e.unitPrice*e.quantity))}}function Z(n,o){if(n&1&&(t(0,"div",28)(1,"span"),a(2,"Tax"),i(),t(3,"span"),a(4),x(5,"currency"),i()()),n&2){let e=p(2);r(4),l(u(5,1,e.order.total_price-e.subtotal))}}function ee(n,o){if(n&1&&(t(0,"div",14)(1,"div")(2,"h4",15),a(3),i(),t(4,"span",12),a(5),x(6,"date"),i()(),t(7,"div",16)(8,"span"),a(9),x(10,"titlecase"),i()()(),t(11,"div",17)(12,"div",18),h(13,H,7,6,"div",19,G),i()(),t(15,"div",20)(16,"div",21)(17,"div",22)(18,"div",23)(19,"h6",24),a(20),i()(),d(21,N,2,0,"div",25),h(22,Y,12,9,"div",26,k().trackByItemId,!0),i()(),t(24,"div")(25,"div",17)(26,"h6",27),a(27,"Order Summary"),i(),t(28,"div",28)(29,"span"),a(30,"Subtotal"),i(),t(31,"span"),a(32),x(33,"currency"),i()(),t(34,"div",28)(35,"span"),a(36,"Shipping"),i(),t(37,"span",29),a(38,"Free"),i()(),d(39,Z,6,3,"div",28),t(40,"div",30)(41,"span",11),a(42,"Total"),i(),t(43,"span",31),a(44),x(45,"currency"),i()()(),t(46,"div",32)(47,"h6",33),v(),t(48,"svg",34),c(49,"path",35)(50,"path",36),i(),a(51," Shipping "),i(),_(),t(52,"div",12)(53,"p",37),a(54),i(),t(55,"p",37),a(56),i(),t(57,"p",38),a(58),i(),t(59,"div",39)(60,"span"),a(61,"Payment"),i(),t(62,"span",40),a(63),i()()()()()()),n&2){let e=p();r(3),b("Order #",e.order._id.slice(-8).toUpperCase()),r(2),l(D(6,17,e.order.createdAt,"MMMM d, y \u2014 h:mm a")),r(3),f(M("inline-block px-3 py-1 rounded-full text-sm font-semibold badge-status-",e.order.status)),r(),l(u(10,20,e.order.status)),r(4),C(e.timelineSteps),r(7),b("Items (",e.totalQuantity,")"),r(),m(e.order.items.length===0?21:-1),r(),C(e.order.items),r(10),l(u(33,22,e.subtotal)),r(7),m(e.order.total_price!==e.subtotal?39:-1),r(5),l(u(45,24,e.order.total_price)),r(10),l(e.order.shipping_address.street),r(2),I("",e.order.shipping_address.city,", ",e.order.shipping_address.state," ",e.order.shipping_address.zip),r(2),l(e.order.shipping_address.country),r(5),l(e.order.payment_method)}}var A=class n{order=null;loading=!0;error="";showCancelModal=!1;cancelLoading=!1;cancelError="";route=g(P);router=g($);orderService=g(L);ngOnInit(){let o=this.route.snapshot.paramMap.get("id");if(!o){this.error="Invalid order ID",this.loading=!1;return}this.loadOrder(o)}loadOrder(o){this.loading=!0,this.error="",this.orderService.getOrderById(o).subscribe({next:e=>{this.order=e.order,this.loading=!1,console.log("Order detail:",this.order)},error:e=>{this.loading=!1,this.error=e?.error?.error||e?.message||"Failed to load order"}})}openCancelModal(){this.showCancelModal=!0,this.cancelError=""}closeCancelModal(){this.showCancelModal=!1}getStatusConfig(o){return{processing:{color:"text-blue-800",bgColor:"bg-blue-100 border-blue-200",icon:"\u2699\uFE0F"},out_for_delivery:{color:"text-purple-800",bgColor:"bg-purple-100 border-purple-200",icon:"\u{1F69A}"},delivered:{color:"text-green-800",bgColor:"bg-green-100 border-green-200",icon:"\u2705"}}[o]||{color:"text-gray-800",bgColor:"bg-gray-100",icon:"\u{1F4E6}"}}get timelineSteps(){if(!this.order)return[];let o=["processing","out_for_delivery","delivered"],e=o.indexOf(this.order.status);return o.map((s,w)=>({label:s.charAt(0).toUpperCase()+s.slice(1),done:w<=e,active:w===e}))}get subtotal(){return this.order?this.order.items.reduce((o,e)=>o+e.unitPrice*e.quantity,0):0}get totalQuantity(){return this.order?this.order.items.reduce((o,e)=>o+e.quantity,0):0}trackByItemId(o,e){return e._id}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=y({type:n,selectors:[["app-order-detail"]],decls:8,vars:3,consts:[[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8","py-6"],["routerLink","/orders",1,"text-sm","text-text-muted","hover:text-text-main","inline-flex","items-center","gap-1","mb-3","transition-colors"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-3.5","h-3.5"],["stroke-linecap","round","stroke-linejoin","round","d","M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"],[1,"space-y-3"],[1,"bg-white","rounded-lg","shadow-sm","text-center","py-8"],[1,"h-8","bg-bg-soft","rounded","w-1/3"],[1,"h-20","bg-bg-soft","rounded","w-full"],[1,"h-48","bg-bg-soft","rounded","w-full"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-8","h-8","text-red-600","mx-auto","mb-3"],["stroke-linecap","round","stroke-linejoin","round","d","M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"],[1,"font-semibold"],[1,"text-sm","text-text-muted"],["routerLink","/orders",1,"inline-block","mt-3","px-3","py-1","bg-accent","hover:bg-accent-hover","text-white","text-sm","rounded","transition-colors"],[1,"flex","flex-col","md:flex-row","justify-between","md:items-center","gap-3","mb-4"],[1,"font-bold","mb-1"],[1,"flex","items-center","gap-2"],[1,"bg-white","rounded-lg","shadow-sm","mb-4","p-4"],[1,"flex","justify-between","items-center"],[1,"text-center",2,"z-index","1"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-4"],[1,"lg:col-span-2"],[1,"bg-white","rounded-lg","shadow-sm","overflow-hidden"],[1,"px-4","py-3","border-b"],[1,"font-semibold","mb-0"],[1,"p-6","text-center","text-text-muted"],[1,"flex","items-center","gap-3","px-4","py-4","border-b"],[1,"font-semibold","mb-3"],[1,"flex","justify-between","text-sm","text-text-muted","mb-2"],[1,"text-accent","font-medium"],[1,"border-t","mt-3","pt-3","flex","justify-between"],[1,"font-semibold","text-lg"],[1,"bg-white","rounded-lg","shadow-sm","p-4"],[1,"font-semibold","mb-2","inline-flex","items-center","gap-2"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","d","M15 10.5a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","d","M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z"],[1,"mb-1"],[1,"mb-3"],[1,"border-t","pt-3","flex","justify-between","items-center"],[1,"uppercase","font-medium"],[1,"mx-auto","mb-2","flex","items-center","justify-center","rounded-full",2,"width","40px","height","40px"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-5","h-5"],[1,"font-semibold","text-sm"],["stroke-linecap","round","stroke-linejoin","round","d","M4.5 12.75l6 6 9-13.5"],[1,"rounded",2,"width","60px","height","75px","object-fit","cover",3,"src","alt"],[1,"bg-bg-soft","rounded","flex","items-center","justify-center",2,"width","60px","height","75px"],[1,"flex-1"],[1,"mb-0","text-text-muted","italic"],[1,"text-sm","text-text-muted","block","mt-1"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-6","h-6","text-text-muted"],["stroke-linecap","round","stroke-linejoin","round","d","M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25"],[1,"mb-0","font-semibold"]],template:function(e,s){e&1&&(t(0,"div",0)(1,"a",1),v(),t(2,"svg",2),c(3,"path",3),i(),a(4," Back to Orders "),i(),d(5,U,4,0,"div",4),d(6,V,9,1,"div",5),d(7,ee,64,26),i()),e&2&&(r(5),m(s.loading?5:-1),r(),m(s.error&&!s.loading?6:-1),r(),m(s.order&&!s.loading?7:-1))},dependencies:[F,z,T,j,B],encapsulation:2})};export{A as OrderDetailComponent};
