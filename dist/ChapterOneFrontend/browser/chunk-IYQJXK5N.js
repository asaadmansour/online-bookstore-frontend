import{b as M}from"./chunk-DZG2A23L.js";import{a as V,b as p,c as T,d as I,f as k,g as L,h as R,l as A,m as F,o as N}from"./chunk-SPKWXH6Y.js";import"./chunk-HOACR73J.js";import{$ as n,I as a,Ja as _,L as s,M as C,Pa as w,Ra as S,Sa as E,U as m,V as u,_ as f,aa as l,ba as h,ha as v,ja as g,ma as r,na as y,oa as c,y as x,z as b}from"./chunk-VPDMBE7M.js";function G(e,o){if(e&1&&(n(0,"div",8),r(1),l()),e&2){let t=g();a(),c(" ",t.error," ")}}function D(e,o){if(e&1&&(n(0,"div",9),r(1),l()),e&2){let t=g();a(),c(" ",t.success," ")}}function B(e,o){e&1&&(n(0,"p",12),r(1,"Enter the 6-character code (letters or digits)"),l())}function O(e,o){e&1&&r(0," Sending\u2026 ")}function q(e,o){if(e&1&&r(0),e&2){let t=g();c(" Resend in ",t.resendCooldown,"s ")}}function z(e,o){e&1&&r(0," Resend Code ")}var j=class e{constructor(o,t,i,d){this.fb=o;this.auth=t;this.route=i;this.router=d;this.form=this.fb.group({code:["",[p.required,p.minLength(6),p.maxLength(6),p.pattern(/^[A-Za-z0-9]{6}$/)]]})}form;email="";error="";success="";loading=!1;resendLoading=!1;resendCooldown=0;cooldownTimer=null;ngOnInit(){this.email=this.route.snapshot.queryParams.email??""}onSubmit(){if(this.form.invalid){this.form.markAllAsTouched();return}this.loading=!0,this.error="",this.success="";let o=String(this.form.value.code||"").trim().toUpperCase();this.auth.verifyEmail(o).subscribe({next:t=>{this.loading=!1,this.success=t.message||"Email verified! Redirecting\u2026",setTimeout(()=>this.router.navigate(["/auth/login"]),2e3)},error:t=>{this.loading=!1,this.error=t?.error?.error||t?.message||"Verification failed"}})}resend(){!this.email||this.resendCooldown>0||(this.resendLoading=!0,this.error="",this.success="",this.auth.resendVerification(this.email).subscribe({next:()=>{this.resendLoading=!1,this.success="New code sent! Check your inbox.",this.startCooldown()},error:o=>{this.resendLoading=!1,this.error=o?.error?.error||o?.message||"Could not resend code"}}))}startCooldown(){this.resendCooldown=60,this.cooldownTimer=setInterval(()=>{this.resendCooldown--,this.resendCooldown<=0&&this.cooldownTimer&&clearInterval(this.cooldownTimer)},1e3)}static \u0275fac=function(t){return new(t||e)(s(F),s(M),s(w),s(S))};static \u0275cmp=C({type:e,selectors:[["app-verify-email"]],decls:27,vars:9,consts:[[1,"min-h-screen","flex","items-center","justify-center","bg-gray-50","px-4"],[1,"w-full","max-w-md","bg-white","rounded-2xl","shadow-lg","p-8","text-center"],[1,"mx-auto","mb-4","flex","h-16","w-16","items-center","justify-center","rounded-full","bg-blue-100"],["fill","none","stroke","currentColor","stroke-width","2","viewBox","0 0 24 24",1,"h-8","w-8","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","d","M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"],[1,"text-2xl","font-bold","mb-2"],[1,"text-gray-500","text-sm","mb-6"],[1,"text-gray-700"],[1,"mb-4","rounded-lg","bg-red-50","border","border-red-200","text-red-700","px-4","py-3","text-sm"],[1,"mb-4","rounded-lg","bg-green-50","border","border-green-200","text-green-700","px-4","py-3","text-sm"],[1,"space-y-6",3,"ngSubmit","formGroup"],["type","text","formControlName","code","maxlength","6","placeholder","------",1,"w-64","mx-auto","block","text-center","text-3xl","tracking-[0.5em]","font-mono","border","border-gray-300","rounded-lg","px-4","py-3","focus:ring-2","focus:ring-blue-500","outline-none"],[1,"text-red-500","text-xs"],["type","submit",1,"w-full","bg-blue-600","hover:bg-blue-700","disabled:bg-blue-400","text-white","font-semibold","py-2.5","rounded-lg","transition",3,"disabled"],[1,"mt-6","text-sm","text-gray-500"],[1,"text-blue-600","hover:underline","font-medium","disabled:text-gray-400","disabled:no-underline",3,"click","disabled"],[1,"mt-4","text-sm"],["routerLink","/auth/login",1,"text-blue-600","hover:underline"]],template:function(t,i){if(t&1&&(n(0,"div",0)(1,"div",1)(2,"div",2),x(),n(3,"svg",3),h(4,"path",4),l()(),b(),n(5,"h1",5),r(6,"Verify Your Email"),l(),n(7,"p",6),r(8," Enter the 6-digit code sent to "),n(9,"strong",7),r(10),l()(),m(11,G,2,1,"div",8),m(12,D,2,1,"div",9),n(13,"form",10),v("ngSubmit",function(){return i.onSubmit()}),h(14,"input",11),m(15,B,2,0,"p",12),n(16,"button",13),r(17),l()(),n(18,"div",14),r(19," Didn't receive a code? "),n(20,"button",15),v("click",function(){return i.resend()}),m(21,O,1,0)(22,q,1,1)(23,z,1,0),l()(),n(24,"p",16)(25,"a",17),r(26,"\u2190 Back to Login"),l()()()()),t&2){let d;a(10),y(i.email||"your email"),a(),u(i.error?11:-1),a(),u(i.success?12:-1),a(),f("formGroup",i.form),a(2),u((d=i.form.get("code"))!=null&&d.touched&&((d=i.form.get("code"))!=null&&d.invalid)?15:-1),a(),f("disabled",i.loading||i.form.invalid),a(),c(" ",i.loading?"Verifying\u2026":"Verify"," "),a(3),f("disabled",i.resendLoading||i.resendCooldown>0),a(),u(i.resendLoading?21:i.resendCooldown>0?22:23)}},dependencies:[_,N,k,V,T,I,A,R,L,E],encapsulation:2})};export{j as VerifyEmailComponent};
