import{a as k,b as p,c as T,d as I,g as L,j as R,k as M,s as A,t as D,v as F}from"./chunk-7DBQ4MYW.js";import{c as V}from"./chunk-FDXW7EDF.js";import{i as _,k as E,l as S}from"./chunk-Q3W3MUE3.js";import{Bc as b,Ca as r,Ib as o,Jb as v,Kb as w,La as c,Ra as y,Z as f,_ as C,cb as s,db as d,ib as h,jb as n,kb as a,lb as u,ub as x,wb as g}from"./chunk-6EE3YYJG.js";function N(e,t){if(e&1&&(n(0,"div",10),o(1),a()),e&2){let l=g();r(),v(l.error)}}function j(e,t){if(e&1&&(n(0,"div",11),o(1),a()),e&2){let l=g();r(),v(l.success)}}function B(e,t){e&1&&(n(0,"small",14),o(1,"Enter exactly 6 alphanumeric characters"),a())}function O(e,t){e&1&&(f(),n(0,"svg",21),u(1,"circle",22)(2,"path",23),a(),o(3," Verifying\u2026 "))}function z(e,t){e&1&&o(0," Verify Email ")}function q(e,t){e&1&&o(0," Sending\u2026 ")}function H(e,t){if(e&1&&o(0),e&2){let l=g();w(" Resend in ",l.resendCooldown,"s ")}}function P(e,t){e&1&&o(0," Resend Code ")}var G=class e{constructor(t,l,i,m){this.fb=t;this.auth=l;this.route=i;this.router=m;this.form=this.fb.group({code:["",[p.required,p.minLength(6),p.maxLength(6),p.pattern(/^[A-Za-z0-9]{6}$/)]]})}form;email="";error="";success="";loading=!1;resendLoading=!1;resendCooldown=0;cooldownTimer=null;ngOnInit(){this.email=this.route.snapshot.queryParams.email??""}ngOnDestroy(){this.cooldownTimer&&clearInterval(this.cooldownTimer)}onSubmit(){if(this.form.invalid){this.form.markAllAsTouched();return}this.loading=!0,this.error="",this.success="",this.auth.verifyEmail(this.form.value.code).subscribe({next:t=>{this.loading=!1,this.success=t.message||"Email verified! Redirecting\u2026",setTimeout(()=>this.router.navigate(["/auth/login"]),2e3)},error:t=>{this.loading=!1,this.error=t?.error?.error||t?.message||"Verification failed"}})}resend(){!this.email||this.resendCooldown>0||(this.resendLoading=!0,this.error="",this.success="",this.auth.resendVerification(this.email).subscribe({next:()=>{this.resendLoading=!1,this.success="New code sent!",this.startCooldown()},error:t=>{this.resendLoading=!1,this.error=t?.error?.error||t?.message||"Could not resend"}}))}startCooldown(){this.resendCooldown=60,this.cooldownTimer=setInterval(()=>{this.resendCooldown--,this.resendCooldown<=0&&this.cooldownTimer&&clearInterval(this.cooldownTimer)},1e3)}static \u0275fac=function(l){return new(l||e)(c(D),c(V),c(_),c(E))};static \u0275cmp=y({type:e,selectors:[["app-verify-email"]],decls:31,vars:9,consts:[[1,"min-h-screen","flex","items-center","justify-center",2,"background","var(--color-bg)"],[1,"w-full","max-w-md","px-4"],[1,"bg-white","rounded-lg","shadow-md"],[1,"p-6","text-center"],[1,"mx-auto","mb-3","rounded-full","flex","items-center","justify-center","bg-green-50",2,"width","64px","height","64px"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-7","h-7","text-green-600"],["stroke-linecap","round","stroke-linejoin","round","d","M21.75 9v.906a2.25 2.25 0 01-1.183 1.981l-6.478 3.488M2.25 9v.906a2.25 2.25 0 001.183 1.981l6.478 3.488m8.839 2.51l-4.66-2.51m0 0l-1.023-.55a2.25 2.25 0 00-2.134 0l-1.022.55m0 0l-4.661 2.51m16.5 1.615a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V8.844a2.25 2.25 0 011.183-1.98l7.5-4.04a2.25 2.25 0 012.134 0l7.5 4.04a2.25 2.25 0 011.183 1.98V17.625z"],[1,"font-semibold","mb-1"],[1,"text-sm","text-gray-500","mb-4"],[1,"text-gray-900"],[1,"bg-red-50","text-red-700","rounded","px-3","py-2","text-sm","mb-2"],[1,"bg-green-50","text-green-700","rounded","px-3","py-2","text-sm","mb-2"],[1,"mb-3",3,"ngSubmit","formGroup"],["type","text","formControlName","code","maxlength","6","placeholder","------",1,"w-full","text-center","font-mono","font-semibold","mb-3","border","border-gray-200","rounded","px-3","py-3","focus:outline-none","focus:ring-2","focus:ring-green-500","uppercase",2,"letter-spacing","0.5em","font-size","1.75rem"],[1,"text-red-600","block","mb-3"],["type","submit",1,"w-full","px-4","py-2","bg-gradient-to-r","from-green-500","to-green-400","text-white","rounded","font-semibold",3,"disabled"],[1,"text-sm","text-gray-500","mb-0"],[1,"text-sm","font-semibold","text-gray-700","ml-1",3,"click","disabled"],["routerLink","/auth/login",1,"text-sm","text-gray-500","block","mt-3","inline-flex","items-center","gap-1"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-3.5","h-3.5"],["stroke-linecap","round","stroke-linejoin","round","d","M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","h-4","w-4","inline-block","mr-2","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z",1,"opacity-75"]],template:function(l,i){if(l&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),f(),n(5,"svg",5),u(6,"path",6),a()(),C(),n(7,"h5",7),o(8,"Verify Your Email"),a(),n(9,"p",8),o(10,"Enter the 6-digit code sent to "),n(11,"strong",9),o(12),a()(),s(13,N,2,1,"div",10),s(14,j,2,1,"div",11),n(15,"form",12),x("ngSubmit",function(){return i.onSubmit()}),u(16,"input",13),s(17,B,2,0,"small",14),n(18,"button",15),s(19,O,4,0)(20,z,1,0),a()(),n(21,"p",16),o(22," Didn't receive a code? "),n(23,"button",17),x("click",function(){return i.resend()}),s(24,q,1,0)(25,H,1,1)(26,P,1,0),a()(),n(27,"a",18),f(),n(28,"svg",19),u(29,"path",20),a(),o(30," Back to Sign In "),a()()()()()),l&2){let m;r(12),v(i.email||"your email"),r(),d(i.error?13:-1),r(),d(i.success?14:-1),r(),h("formGroup",i.form),r(2),d((m=i.form.get("code"))!=null&&m.touched&&((m=i.form.get("code"))!=null&&m.invalid)?17:-1),r(),h("disabled",i.loading||i.form.invalid),r(),d(i.loading?19:20),r(4),h("disabled",i.resendLoading||i.resendCooldown>0),r(),d(i.resendLoading?24:i.resendCooldown>0?25:26)}},dependencies:[b,F,L,k,T,I,A,M,R,S],encapsulation:2})};export{G as VerifyEmailComponent};
