import{a as H}from"./chunk-WCXXVY4N.js";import{a as G,b as x,c as B,d as U,g as j,j as z,k as O,t as R,v as q}from"./chunk-7DBQ4MYW.js";import{c as D}from"./chunk-FDXW7EDF.js";import"./chunk-Q3W3MUE3.js";import{Bc as L,Ca as a,Fb as E,Hb as k,Ib as o,Jb as g,Kb as V,La as b,Ra as y,Sb as I,Vb as A,Wb as M,X as h,Y as C,Z as _,cb as m,db as c,fb as N,gb as P,hb as T,ib as v,jb as n,kb as i,lb as u,sb as w,ub as S,wb as f,yc as F}from"./chunk-6EE3YYJG.js";var $=()=>[1,2,3,4];function J(e,l){e&1&&u(0,"div",5)}function K(e,l){e&1&&(n(0,"div",0)(1,"div",4),P(2,J,1,0,"div",5,N),i()()),e&2&&(a(2),T(I(0,$)))}function Q(e,l){if(e&1&&(n(0,"div",1),_(),n(1,"svg",6),u(2,"path",7),i(),o(3),i()),e&2){let t=f();a(3),V(" ",t.error,`
`)}}function W(e,l){if(e&1&&(n(0,"div",2),_(),n(1,"svg",6),u(2,"path",8),i(),o(3),i()),e&2){let t=f();a(3),V(" ",t.success,`
`)}}function X(e,l){e&1&&(n(0,"span",14),o(1,"Verified"),i())}function Y(e,l){e&1&&(n(0,"span",15),o(1,"Unverified"),i())}function ee(e,l){if(e&1){let t=w();n(0,"div",9)(1,"div")(2,"label",10),o(3,"FIRST NAME"),i(),n(4,"p",11),o(5),i()(),n(6,"div")(7,"label",10),o(8,"LAST NAME"),i(),n(9,"p",11),o(10),i()(),n(11,"div")(12,"label",10),o(13,"EMAIL"),i(),n(14,"div",12)(15,"span",13),o(16),i(),m(17,X,2,0,"span",14)(18,Y,2,0,"span",15),i()(),n(19,"div")(20,"label",10),o(21,"DATE OF BIRTH"),i(),n(22,"p",11),o(23),i()(),n(24,"div")(25,"label",10),o(26,"ROLE"),i(),n(27,"div")(28,"span",16),o(29),A(30,"titlecase"),i()()(),n(31,"div")(32,"label",10),o(33,"MEMBER SINCE"),i(),n(34,"p",11),o(35),i()()(),n(36,"div",17)(37,"button",18),S("click",function(){h(t);let s=f();return C(s.startEditing())}),_(),n(38,"svg",19),u(39,"path",20),i(),o(40," Edit Profile "),i()()}if(e&2){let t=f();a(5),g(t.user.firstName),a(5),g(t.user.lastName),a(6),g(t.user.email),a(),c(t.user.isVerified?17:18),a(6),g(t.formattedDob),a(5),k(t.user.role==="admin"?"bg-purple-100 text-purple-700":"bg-green-100 text-green-700"),a(),g(M(30,9,t.user.role)),a(6),g(t.memberSince)}}function te(e,l){e&1&&o(0," First name is required ")}function ie(e,l){e&1&&o(0," Minimum 3 characters ")}function ne(e,l){e&1&&o(0," Letters only ")}function oe(e,l){if(e&1&&(n(0,"div",24),m(1,te,1,0)(2,ie,1,0)(3,ne,1,0),i()),e&2){let t,r=f(2);a(),c((t=r.form.get("firstName"))!=null&&t.hasError("required")?1:(t=r.form.get("firstName"))!=null&&t.hasError("minlength")?2:(t=r.form.get("firstName"))!=null&&t.hasError("pattern")?3:-1)}}function re(e,l){e&1&&o(0," Last name is required ")}function le(e,l){e&1&&o(0," Minimum 3 characters ")}function ae(e,l){e&1&&o(0," Letters only ")}function de(e,l){if(e&1&&(n(0,"div",24),m(1,re,1,0)(2,le,1,0)(3,ae,1,0),i()),e&2){let t,r=f(2);a(),c((t=r.form.get("lastName"))!=null&&t.hasError("required")?1:(t=r.form.get("lastName"))!=null&&t.hasError("minlength")?2:(t=r.form.get("lastName"))!=null&&t.hasError("pattern")?3:-1)}}function se(e,l){e&1&&(_(),n(0,"svg",33),u(1,"circle",34)(2,"path",35),i(),o(3,"Saving\u2026 "))}function me(e,l){e&1&&(_(),n(0,"svg",19),u(1,"path",36),i(),o(2," Save Changes "))}function ce(e,l){if(e&1){let t=w();n(0,"form",21),S("ngSubmit",function(){h(t);let s=f();return C(s.saveProfile())}),n(1,"div",22)(2,"div")(3,"label",10),o(4,"FIRST NAME"),i(),u(5,"input",23),m(6,oe,4,1,"div",24),i(),n(7,"div")(8,"label",10),o(9,"LAST NAME"),i(),u(10,"input",25),m(11,de,4,1,"div",24),i(),n(12,"div")(13,"label",10),o(14,"DATE OF BIRTH "),n(15,"span",26),o(16,"(optional)"),i()(),u(17,"input",27),i(),n(18,"div")(19,"label",10),o(20,"EMAIL "),n(21,"span",26),o(22,"(cannot change)"),i()(),u(23,"input",28),i()(),u(24,"div",29),n(25,"div",30)(26,"button",31),m(27,se,4,0)(28,me,3,0),i(),n(29,"button",32),S("click",function(){h(t);let s=f();return C(s.cancelEditing())}),o(30,"Cancel"),i()()()}if(e&2){let t,r,s,p,d=f();v("formGroup",d.form),a(5),E("border-red-500",((t=d.form.get("firstName"))==null?null:t.touched)&&((t=d.form.get("firstName"))==null?null:t.invalid)),a(),c((r=d.form.get("firstName"))!=null&&r.touched&&((r=d.form.get("firstName"))!=null&&r.invalid)?6:-1),a(4),E("border-red-500",((s=d.form.get("lastName"))==null?null:s.touched)&&((s=d.form.get("lastName"))==null?null:s.invalid)),a(),c((p=d.form.get("lastName"))!=null&&p.touched&&((p=d.form.get("lastName"))!=null&&p.invalid)?11:-1),a(12),v("value",d.user.email),a(3),v("disabled",d.saving||d.form.invalid||d.form.pristine),a(),c(d.saving?27:28),a(2),v("disabled",d.saving)}}var Z=class e{constructor(l,t,r){this.fb=l;this.userService=t;this.authService=r;this.form=this.fb.group({firstName:["",[x.required,x.minLength(3),x.maxLength(15),x.pattern(/^[A-Za-z]+$/)]],lastName:["",[x.required,x.minLength(3),x.maxLength(15),x.pattern(/^[A-Za-z]+$/)]],dob:[""]})}user=null;form;loading=!0;saving=!1;editing=!1;error="";success="";ngOnInit(){this.loadProfile()}loadProfile(){this.loading=!0,this.error="",this.userService.getProfile().subscribe({next:l=>{this.user=l.user,this.populateForm(),this.loading=!1},error:l=>{this.loading=!1,this.error=l?.error?.error||l?.message||"Failed to load profile"}})}populateForm(){this.user&&this.form.patchValue({firstName:this.user.firstName,lastName:this.user.lastName,dob:this.user.dob?new Date(this.user.dob).toISOString().split("T")[0]:""})}startEditing(){this.editing=!0,this.success="",this.error=""}cancelEditing(){this.editing=!1,this.populateForm(),this.error=""}saveProfile(){if(this.form.invalid){this.form.markAllAsTouched();return}this.saving=!0,this.error="",this.success="";let{firstName:l,lastName:t,dob:r}=this.form.value,s={firstName:l,lastName:t};r&&(s.dob=r),this.userService.updateProfile(s).subscribe({next:p=>{this.saving=!1,this.editing=!1,this.user=p.user,this.success=p.message||"Profile updated successfully!",this.authService.updateCurrentUser(p.user),setTimeout(()=>this.success="",4e3)},error:p=>{this.saving=!1,this.error=p?.error?.error||p?.message||"Failed to update profile"}})}get memberSince(){return this.user?.createdAt?new Date(this.user.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):""}get formattedDob(){return this.user?.dob?new Date(this.user.dob).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Not set"}static \u0275fac=function(t){return new(t||e)(b(R),b(H),b(D))};static \u0275cmp=y({type:e,selectors:[["app-view-profile"]],decls:5,vars:5,consts:[[1,"animate-pulse"],[1,"bg-red-50","border","border-red-100","text-red-700","text-sm","px-3","py-2","rounded","flex","items-center","gap-2"],[1,"bg-green-50","border","border-green-100","text-green-700","text-sm","px-3","py-2","rounded","flex","items-center","gap-2"],[3,"formGroup"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"h-14","bg-gray-200","rounded"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-4","h-4","shrink-0"],["stroke-linecap","round","stroke-linejoin","round","d","M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"],["stroke-linecap","round","stroke-linejoin","round","d","M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","mb-4"],[1,"text-xs","text-text-muted"],[1,"font-medium","mb-0"],[1,"flex","items-center","gap-2"],[1,"font-medium"],[1,"inline-block","bg-green-100","text-green-700","text-xs","px-2","py-0.5","rounded"],[1,"inline-block","bg-yellow-100","text-yellow-800","text-xs","px-2","py-0.5","rounded"],[1,"inline-block","px-2","py-0.5","rounded","text-xs","font-semibold"],[1,"mt-4"],[1,"px-3","py-2","bg-accent","hover:bg-accent-hover","text-white","rounded","text-sm","inline-flex","items-center","gap-2","transition-colors",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","d","M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"],[3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-3","mb-4"],["type","text","formControlName","firstName","placeholder","John",1,"border","border-border-light","rounded","px-3","py-2","w-full","text-text-main","outline-none","hover:border-accent/60","focus:border-accent","bg-bg-soft","transition-colors"],[1,"text-red-600","text-sm","mt-1"],["type","text","formControlName","lastName","placeholder","Doe",1,"border","border-border-light","rounded","px-3","py-2","w-full","text-text-main","outline-none","hover:border-accent/60","focus:border-accent","bg-bg-soft","transition-colors"],[1,"text-gray-400","text-xs"],["type","date","formControlName","dob",1,"border","border-border-light","rounded","px-3","py-2","w-full","text-text-main","outline-none","hover:border-accent/60","focus:border-accent","bg-bg-soft","transition-colors"],["type","email","disabled","",1,"border","border-border-light","bg-bg-soft","rounded","px-3","py-2","w-full","text-text-muted",3,"value"],[1,"border-t","my-4"],[1,"flex","gap-2"],["type","submit",1,"px-4","py-2","bg-accent","hover:bg-accent-hover","text-white","rounded","inline-flex","items-center","gap-2","transition-colors",3,"disabled"],["type","button",1,"px-4","py-2","bg-bg-soft","border","border-border-light","rounded","text-text-muted","hover:text-text-main","transition-colors",3,"click","disabled"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-2","h-4","w-4","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z",1,"opacity-75"],["stroke-linecap","round","stroke-linejoin","round","d","M4.5 12.75l6 6 9-13.5"]],template:function(t,r){t&1&&(m(0,K,4,1,"div",0),m(1,Q,4,1,"div",1),m(2,W,4,1,"div",2),m(3,ee,41,11),m(4,ce,31,11,"form",3)),t&2&&(c(r.loading?0:-1),a(),c(r.error&&!r.loading?1:-1),a(),c(r.success?2:-1),a(),c(r.user&&!r.loading&&!r.editing?3:-1),a(),c(r.user&&!r.loading&&r.editing?4:-1))},dependencies:[L,q,j,G,B,U,O,z,F],encapsulation:2})};export{Z as ViewProfileComponent};
