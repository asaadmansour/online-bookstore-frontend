import{b as Y}from"./chunk-7LAB7N4Z.js";import{c as J,f as K,l as Q,m as X,o as Z,u as ee}from"./chunk-7DBQ4MYW.js";import{l as q}from"./chunk-Q3W3MUE3.js";import{Ac as z,Bc as U,Ca as a,Fb as V,Hb as B,Ib as l,Jb as c,Kb as F,Lb as E,Nb as N,Ob as D,Pb as A,Qb as j,Ra as k,S as T,Sb as $,Tb as R,Vb as y,Wb as P,X as b,Xb as G,Y as h,Z as S,_ as O,bb as L,cb as m,db as p,eb as M,fb as I,gb as v,hb as C,ib as f,jb as o,kb as n,lb as g,sb as w,ub as _,wb as s,yc as H,zc as W}from"./chunk-6EE3YYJG.js";var ie=()=>[1,2,3],ne=i=>["/orders",i],re=(i,t)=>t.value;function oe(i,t){if(i&1&&(o(0,"p",3),l(1),n()),i&2){let e=s();a(),E("",e.totalItems," order",e.totalItems!==1?"s":"")}}function ae(i,t){if(i&1&&(o(0,"option",5),l(1),n()),i&2){let e=t.$implicit;f("value",e.value),a(),c(e.label)}}function le(i,t){i&1&&(o(0,"div",10),g(1,"div",11)(2,"div",12)(3,"div",13)(4,"div",11),n())}function de(i,t){i&1&&(o(0,"div",6)(1,"div",9),v(2,le,5,0,"div",10,I),n()()),i&2&&(a(2),C($(0,ie)))}function se(i,t){if(i&1){let e=w();o(0,"div",7)(1,"div",14),S(),o(2,"svg",15),g(3,"path",16),n(),O(),o(4,"h6",17),l(5,"Something went wrong"),n(),o(6,"p",18),l(7),n(),o(8,"button",19),_("click",function(){b(e);let d=s();return h(d.loadOrders())}),l(9,"Try Again"),n()()()}if(i&2){let e=s();a(7),c(e.error)}}function ce(i,t){i&1&&(o(0,"div",7)(1,"div",14),S(),o(2,"svg",20),g(3,"path",21),n(),O(),o(4,"h6",17),l(5,"No orders yet"),n(),o(6,"p",18),l(7,"Start browsing and place your first order!"),n(),o(8,"a",22),l(9,"Browse Books"),n()()())}function me(i,t){if(i&1&&(o(0,"tr",28)(1,"td",27)(2,"span",17),l(3),n()(),o(4,"td",27)(5,"span",30),l(6),y(7,"date"),n()(),o(8,"td",27)(9,"span",30),l(10),n()(),o(11,"td",27)(12,"span",17),l(13),y(14,"currency"),n()(),o(15,"td",27)(16,"span"),l(17),y(18,"titlecase"),n()(),o(19,"td",27)(20,"span",31),l(21),n()(),o(22,"td",32),S(),o(23,"svg",33),g(24,"path",34),n()()()),i&2){let e=t.$implicit,r=s(2);f("routerLink",R(17,ne,e._id)),a(3),F("#",e._id.slice(-8).toUpperCase()),a(3),c(G(7,10,e.createdAt,"MMM d, y")),a(4),c(r.getItemsSummary(e)),a(3),c(P(14,13,e.total_price)),a(3),B(j("inline-block px-3 py-1 rounded-full text-sm font-semibold badge-status-",e.status)),a(),c(P(18,15,e.status)),a(4),c(e.payment_method)}}function pe(i,t){i&1&&(o(0,"li")(1,"span",37),l(2,"\u2026"),n()())}function ue(i,t){if(i&1){let e=w();o(0,"li")(1,"button",38),_("click",function(){b(e);let d=s().$implicit,u=s(3);return h(u.goToPage(+d))}),l(2),n()()}if(i&2){let e=s().$implicit,r=s(3);a(),V("bg-accent",e===r.currentPage)("text-white",e===r.currentPage)("text-text-muted",e!==r.currentPage),a(),c(e)}}function xe(i,t){if(i&1&&m(0,pe,3,0,"li")(1,ue,3,7,"li"),i&2){let e=t.$implicit;p(e==="..."?0:1)}}function ge(i,t){if(i&1){let e=w();o(0,"div",29)(1,"small",30),l(2),n(),o(3,"nav")(4,"ul",35)(5,"li")(6,"button",36),_("click",function(){b(e);let d=s(2);return h(d.goToPage(d.currentPage-1))}),l(7,"Previous"),n()(),v(8,xe,2,1,null,null,M),o(10,"li")(11,"button",36),_("click",function(){b(e);let d=s(2);return h(d.goToPage(d.currentPage+1))}),l(12,"Next"),n()()()()()}if(i&2){let e=s(2);a(2),E(" Page ",e.currentPage," of ",e.totalPages," "),a(4),f("disabled",e.currentPage===1),a(2),C(e.pageNumbers),a(3),f("disabled",e.currentPage===e.totalPages)}}function _e(i,t){if(i&1&&(o(0,"div",8)(1,"div",23)(2,"table",24)(3,"thead",25)(4,"tr",26)(5,"th",27),l(6,"ORDER"),n(),o(7,"th",27),l(8,"DATE"),n(),o(9,"th",27),l(10,"ITEMS"),n(),o(11,"th",27),l(12,"TOTAL"),n(),o(13,"th",27),l(14,"STATUS"),n(),o(15,"th",27),l(16,"PAYMENT"),n(),g(17,"th",27),n()(),o(18,"tbody"),v(19,me,25,19,"tr",28,L().trackByOrderId,!0),n()()(),m(21,ge,13,4,"div",29),n()),i&2){let e=s();a(19),C(e.orders),a(2),p(e.totalPages>1?21:-1)}}var te=class i{orders=[];loading=!0;error="";currentPage=1;totalPages=1;totalItems=0;limit=10;selectedStatus="all";statuses=[{value:"all",label:"All Orders"},{value:"processing",label:"Processing"},{value:"out_for_delivery",label:"Out for Delivery"},{value:"delivered",label:"Delivered"}];orderService=T(Y);ngOnInit(){this.loadOrders()}loadOrders(){this.loading=!0,this.error="",this.orderService.getOrders(this.currentPage,this.limit,this.selectedStatus).subscribe({next:t=>{this.orders=t.items,this.totalItems=t.total,this.totalPages=t.PagesNumber,this.loading=!1,console.log("Orders loaded:",this.orders)},error:t=>{if(this.loading=!1,t?.status===404){this.orders=[];return}this.error=t?.error?.message||t?.error?.error||"Failed to load orders. Please try again.",console.error("Order load error:",t)}})}onStatusChange(){this.currentPage=1,this.loadOrders()}goToPage(t){t<1||t>this.totalPages||(this.currentPage=t,this.loadOrders(),window.scrollTo({top:0,behavior:"smooth"}))}get pageNumbers(){let t=this.totalPages,e=this.currentPage,r=[];if(t<=7){for(let x=1;x<=t;x++)r.push(x);return r}r.push(1),e>3&&r.push("...");let d=Math.max(2,e-1),u=Math.min(t-1,e+1);for(let x=d;x<=u;x++)r.push(x);return e<t-2&&r.push("..."),r.push(t),r}getStatusConfig(t){return{processing:{color:"bg-blue-100 text-blue-800 border-blue-200",icon:"\u2699\uFE0F"},out_for_delivery:{color:"bg-purple-100 text-purple-800 border-purple-200",icon:"\u{1F69A}"},delivered:{color:"bg-green-100 text-green-800 border-green-200",icon:"\u2705"}}[t]||{color:"bg-gray-100 text-gray-800",icon:"\u{1F4E6}"}}getItemsSummary(t){let e=t.items.reduce((r,d)=>r+d.quantity,0);return`${e} item${e!==1?"s":""}`}trackByOrderId(t,e){return e._id}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=k({type:i,selectors:[["app-order-list"]],decls:13,vars:6,consts:[[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8","py-4"],[1,"flex","flex-col","md:flex-row","justify-between","md:items-center","gap-3","mb-4"],[1,"font-bold","mb-1","text-text-main"],[1,"text-sm","text-text-muted","mb-0"],[1,"border","border-border-light","rounded","px-2","py-1","text-sm","text-text-main","bg-white","outline-none","focus:border-accent",2,"width","auto",3,"ngModelChange","ngModel"],[3,"value"],[1,"bg-white","rounded-lg","shadow-sm","border","border-border-light"],[1,"bg-white","rounded-lg","shadow-sm","border","border-border-light","text-center","py-8"],[1,"bg-white","rounded-lg","shadow-sm","border","border-border-light","overflow-hidden"],[1,"p-4"],[1,"flex","gap-3","py-3","border-b","border-border-light","animate-pulse"],[1,"h-4","bg-bg-soft","rounded","w-1/6"],[1,"h-4","bg-bg-soft","rounded","w-1/4"],[1,"h-4","bg-bg-soft","rounded","w-1/12"],[1,"px-6"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-8","h-8","text-red-500","mx-auto","mb-3"],["stroke-linecap","round","stroke-linejoin","round","d","M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"],[1,"font-semibold","text-text-main"],[1,"text-sm","text-text-muted","mb-3"],[1,"px-3","py-1","bg-accent","hover:bg-accent-hover","text-white","text-sm","rounded","transition-colors",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-8","h-8","text-text-muted","mx-auto","mb-3"],["stroke-linecap","round","stroke-linejoin","round","d","M21 7.5l-9-5.25L3 7.5m18 0l-9 5.25m9-5.25v9l-9 5.25M3 7.5l9 5.25M3 7.5v9l9 5.25m0-9v9"],["routerLink","/books",1,"inline-block","px-3","py-1","bg-accent","hover:bg-accent-hover","text-white","text-sm","rounded","transition-colors"],[1,"overflow-x-auto"],[1,"w-full","text-sm","table-auto"],[1,"bg-bg-soft","border-b","border-border-light"],[1,"text-left","text-xs","text-text-muted"],[1,"px-4","py-3"],[1,"hover:bg-bg-soft","transition-colors","cursor-pointer","border-b","border-border-light","last:border-0",3,"routerLink"],[1,"px-4","py-3","flex","items-center","justify-between","border-t","border-border-light"],[1,"text-sm","text-text-muted"],[1,"text-sm","text-text-muted","uppercase"],[1,"px-4","py-3","text-text-muted"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","d","M8.25 4.5l7.5 7.5-7.5 7.5"],[1,"inline-flex","items-center","space-x-2"],[1,"px-2","py-1","rounded","border","border-border-light","text-sm","text-text-muted","hover:border-accent","hover:text-accent","transition-colors",3,"click","disabled"],[1,"px-2","text-sm","text-text-muted"],[1,"px-3","py-1","rounded","text-sm","transition-colors",3,"click"]],template:function(e,r){e&1&&(o(0,"div",0)(1,"div",1)(2,"div")(3,"h4",2),l(4,"My Orders"),n(),m(5,oe,2,2,"p",3),n(),o(6,"select",4),A("ngModelChange",function(u){return D(r.selectedStatus,u)||(r.selectedStatus=u),u}),_("ngModelChange",function(){return r.onStatusChange()}),v(7,ae,2,2,"option",5,re),n()(),m(9,de,4,1,"div",6),m(10,se,10,1,"div",7),m(11,ce,10,0,"div",7),m(12,_e,22,1,"div",8),n()),e&2&&(a(5),p(!r.loading&&r.totalItems>0?5:-1),a(),N("ngModel",r.selectedStatus),a(),C(r.statuses),a(2),p(r.loading?9:-1),a(),p(r.error&&!r.loading?10:-1),a(),p(!r.loading&&!r.error&&r.orders.length===0?11:-1),a(),p(!r.loading&&!r.error&&r.orders.length>0?12:-1))},dependencies:[U,q,ee,X,Z,Q,J,K,H,z,W],encapsulation:2})};export{te as OrderListComponent};
