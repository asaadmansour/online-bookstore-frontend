import{a as ee}from"./chunk-YRGBYMMP.js";import{c as Y,e as J,i as K,j as Q,k as X,n as Z}from"./chunk-E56WDDHT.js";import"./chunk-HOACR73J.js";import{i as q}from"./chunk-X5XJS3OX.js";import{Aa as P,Ab as G,Ea as k,Oa as L,Pa as m,Qa as p,Qb as H,Ra as M,Rb as W,Sa as I,Sb as z,T as v,Ta as h,Tb as U,U as C,Ua as f,V as S,Va as b,W as O,Wa as r,Xa as n,Ya as x,ab as y,cb as _,eb as s,jb as V,kb as B,lb as l,mb as c,nb as F,ob as E,qb as N,rb as A,sa as a,sb as D,ub as j,wb as $,xb as R,yb as w,zb as T}from"./chunk-QMVCZU7Z.js";var ie=()=>[1,2,3],ne=i=>["/orders",i],re=(i,t)=>t.value;function oe(i,t){if(i&1&&(r(0,"p",3),l(1),n()),i&2){let e=s();a(),E("",e.totalItems," order",e.totalItems!==1?"s":"")}}function ae(i,t){if(i&1&&(r(0,"option",5),l(1),n()),i&2){let e=t.$implicit;b("value",e.value),a(),c(e.label)}}function le(i,t){i&1&&(r(0,"div",10),x(1,"div",11)(2,"div",12)(3,"div",13)(4,"div",11),n())}function de(i,t){i&1&&(r(0,"div",6)(1,"div",9),h(2,le,5,0,"div",10,I),n()()),i&2&&(a(2),f($(0,ie)))}function se(i,t){if(i&1){let e=y();r(0,"div",7)(1,"div",14),S(),r(2,"svg",15),x(3,"path",16),n(),O(),r(4,"h6",17),l(5,"Something went wrong"),n(),r(6,"p",18),l(7),n(),r(8,"button",19),_("click",function(){v(e);let d=s();return C(d.loadOrders())}),l(9,"Try Again"),n()()()}if(i&2){let e=s();a(7),c(e.error)}}function ce(i,t){i&1&&(r(0,"div",7)(1,"div",14),S(),r(2,"svg",20),x(3,"path",21),n(),O(),r(4,"h6",17),l(5,"No orders yet"),n(),r(6,"p",18),l(7,"Start browsing and place your first order!"),n(),r(8,"a",22),l(9,"Browse Books"),n()()())}function me(i,t){if(i&1&&(r(0,"tr",28)(1,"td",27)(2,"span",17),l(3),n()(),r(4,"td",27)(5,"span",30),l(6),w(7,"date"),n()(),r(8,"td",27)(9,"span",30),l(10),n()(),r(11,"td",27)(12,"span",17),l(13),w(14,"currency"),n()(),r(15,"td",27)(16,"span"),l(17),w(18,"titlecase"),n()(),r(19,"td",27)(20,"span",31),l(21),n()(),r(22,"td",32),S(),r(23,"svg",33),x(24,"path",34),n()()()),i&2){let e=t.$implicit,o=s(2);b("routerLink",R(17,ne,e._id)),a(3),F("#",e._id.slice(-8).toUpperCase()),a(3),c(G(7,10,e.createdAt,"MMM d, y")),a(4),c(o.getItemsSummary(e)),a(3),c(T(14,13,e.total_price)),a(3),B(j("inline-block px-3 py-1 rounded-full text-sm font-semibold badge-status-",e.status)),a(),c(T(18,15,e.status)),a(4),c(e.payment_method)}}function pe(i,t){i&1&&(r(0,"li")(1,"span",37),l(2,"\u2026"),n()())}function ue(i,t){if(i&1){let e=y();r(0,"li")(1,"button",38),_("click",function(){v(e);let d=s().$implicit,u=s(3);return C(u.goToPage(+d))}),l(2),n()()}if(i&2){let e=s().$implicit,o=s(3);a(),V("bg-gray-900",e===o.currentPage)("text-white",e===o.currentPage),a(),c(e)}}function ge(i,t){if(i&1&&m(0,pe,3,0,"li")(1,ue,3,5,"li"),i&2){let e=t.$implicit;p(e==="..."?0:1)}}function xe(i,t){if(i&1){let e=y();r(0,"div",29)(1,"small",30),l(2),n(),r(3,"nav")(4,"ul",35)(5,"li")(6,"button",36),_("click",function(){v(e);let d=s(2);return C(d.goToPage(d.currentPage-1))}),l(7,"Previous"),n()(),h(8,ge,2,1,null,null,M),r(10,"li")(11,"button",36),_("click",function(){v(e);let d=s(2);return C(d.goToPage(d.currentPage+1))}),l(12,"Next"),n()()()()()}if(i&2){let e=s(2);a(2),E(" Page ",e.currentPage," of ",e.totalPages," "),a(4),b("disabled",e.currentPage===1),a(2),f(e.pageNumbers),a(3),b("disabled",e.currentPage===e.totalPages)}}function _e(i,t){if(i&1&&(r(0,"div",8)(1,"div",23)(2,"table",24)(3,"thead",25)(4,"tr",26)(5,"th",27),l(6,"ORDER"),n(),r(7,"th",27),l(8,"DATE"),n(),r(9,"th",27),l(10,"ITEMS"),n(),r(11,"th",27),l(12,"TOTAL"),n(),r(13,"th",27),l(14,"STATUS"),n(),r(15,"th",27),l(16,"PAYMENT"),n(),x(17,"th",27),n()(),r(18,"tbody"),h(19,me,25,19,"tr",28,L().trackByOrderId,!0),n()()(),m(21,xe,13,4,"div",29),n()),i&2){let e=s();a(19),f(e.orders),a(2),p(e.totalPages>1?21:-1)}}var te=class i{constructor(t){this.orderService=t}orders=[];loading=!0;error="";currentPage=1;totalPages=1;totalItems=0;limit=10;selectedStatus="all";statuses=[{value:"all",label:"All Orders"},{value:"pending",label:"Pending"},{value:"processing",label:"Processing"},{value:"shipped",label:"Shipped"},{value:"delivered",label:"Delivered"},{value:"cancelled",label:"Cancelled"}];ngOnInit(){this.loadOrders()}loadOrders(){this.loading=!0,this.error="",this.orderService.getMyOrders(this.currentPage,this.limit,this.selectedStatus).subscribe({next:t=>{this.orders=t.items,this.totalItems=t.total,this.totalPages=t.PagesNumber,this.loading=!1,console.log("Orders loaded:",this.orders)},error:t=>{this.loading=!1,this.error=t?.error?.error||t?.message||"Failed to load orders",console.error("Order load error:",t)}})}onStatusChange(){this.currentPage=1,this.loadOrders()}goToPage(t){t<1||t>this.totalPages||(this.currentPage=t,this.loadOrders(),window.scrollTo({top:0,behavior:"smooth"}))}get pageNumbers(){let t=this.totalPages,e=this.currentPage,o=[];if(t<=7){for(let g=1;g<=t;g++)o.push(g);return o}o.push(1),e>3&&o.push("...");let d=Math.max(2,e-1),u=Math.min(t-1,e+1);for(let g=d;g<=u;g++)o.push(g);return e<t-2&&o.push("..."),o.push(t),o}getStatusConfig(t){return{pending:{color:"bg-yellow-100 text-yellow-800 border-yellow-200",icon:"\u{1F550}"},processing:{color:"bg-blue-100 text-blue-800 border-blue-200",icon:"\u2699\uFE0F"},shipped:{color:"bg-purple-100 text-purple-800 border-purple-200",icon:"\u{1F69A}"},delivered:{color:"bg-green-100 text-green-800 border-green-200",icon:"\u2705"},cancelled:{color:"bg-red-100 text-red-800 border-red-200",icon:"\u274C"}}[t]||{color:"bg-gray-100 text-gray-800",icon:"\u{1F4E6}"}}getItemsSummary(t){let e=t.items.reduce((o,d)=>o+d.quantity,0);return`${e} item${e!==1?"s":""}`}trackByOrderId(t,e){return e._id}static \u0275fac=function(e){return new(e||i)(P(ee))};static \u0275cmp=k({type:i,selectors:[["app-order-list"]],decls:13,vars:6,consts:[[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8","py-4"],[1,"flex","flex-col","md:flex-row","justify-between","md:items-center","gap-3","mb-4"],[1,"font-bold","mb-1"],[1,"text-sm","text-gray-500","mb-0"],[1,"border","border-gray-200","rounded","px-2","py-1","text-sm",2,"width","auto",3,"ngModelChange","ngModel"],[3,"value"],[1,"bg-white","rounded-lg","shadow-sm"],[1,"bg-white","rounded-lg","shadow-sm","text-center","py-8"],[1,"bg-white","rounded-lg","shadow-sm","overflow-hidden"],[1,"p-4"],[1,"flex","gap-3","py-3","border-b","animate-pulse"],[1,"h-4","bg-gray-200","rounded","w-1/6"],[1,"h-4","bg-gray-200","rounded","w-1/4"],[1,"h-4","bg-gray-200","rounded","w-1/12"],[1,"px-6"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-8","h-8","text-red-600","mx-auto","mb-3"],["stroke-linecap","round","stroke-linejoin","round","d","M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"],[1,"font-semibold"],[1,"text-sm","text-gray-500","mb-3"],[1,"px-3","py-1","bg-green-600","text-white","text-sm","rounded",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-8","h-8","text-gray-400","mx-auto","mb-3"],["stroke-linecap","round","stroke-linejoin","round","d","M21 7.5l-9-5.25L3 7.5m18 0l-9 5.25m9-5.25v9l-9 5.25M3 7.5l9 5.25M3 7.5v9l9 5.25m0-9v9"],["routerLink","/books",1,"inline-block","px-3","py-1","bg-green-600","text-white","text-sm","rounded"],[1,"overflow-x-auto"],[1,"w-full","text-sm","table-auto"],[1,"bg-gray-50"],[1,"text-left","text-xs","text-gray-600"],[1,"px-4","py-3"],[1,"hover:bg-gray-50","cursor-pointer",3,"routerLink"],[1,"px-4","py-3","flex","items-center","justify-between"],[1,"text-sm","text-gray-500"],[1,"text-sm","text-gray-500","uppercase"],[1,"px-4","py-3","text-gray-400"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","d","M8.25 4.5l7.5 7.5-7.5 7.5"],[1,"inline-flex","items-center","space-x-2"],[1,"px-2","py-1","rounded","border","border-gray-200","text-sm",3,"click","disabled"],[1,"px-2","text-sm","text-gray-500"],[1,"px-3","py-1","rounded","text-sm",3,"click"]],template:function(e,o){e&1&&(r(0,"div",0)(1,"div",1)(2,"div")(3,"h4",2),l(4,"My Orders"),n(),m(5,oe,2,2,"p",3),n(),r(6,"select",4),D("ngModelChange",function(u){return A(o.selectedStatus,u)||(o.selectedStatus=u),u}),_("ngModelChange",function(){return o.onStatusChange()}),h(7,ae,2,2,"option",5,re),n()(),m(9,de,4,1,"div",6),m(10,se,10,1,"div",7),m(11,ce,10,0,"div",7),m(12,_e,22,1,"div",8),n()),e&2&&(a(5),p(!o.loading&&o.totalItems>0?5:-1),a(),N("ngModel",o.selectedStatus),a(),f(o.statuses),a(2),p(o.loading?9:-1),a(),p(o.error&&!o.loading?10:-1),a(),p(!o.loading&&!o.error&&o.orders.length===0?11:-1),a(),p(!o.loading&&!o.error&&o.orders.length>0?12:-1))},dependencies:[U,q,Z,Q,X,K,Y,J,H,z,W],encapsulation:2})};export{te as OrderListComponent};
